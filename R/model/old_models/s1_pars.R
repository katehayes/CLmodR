load("/Users/katehayes/CLmodelR/Output/Data/Input/v_turn10.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/t_turn10.Rdata")

load("/Users/katehayes/CLmodelR/Output/Data/Input/t_end_cust.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_cust10.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_cust11.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_cust12.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_cust13.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_cust14.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_cust15.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_cust16.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_cust17.Rdata")

load("/Users/katehayes/CLmodelR/Output/Data/Input/t_end_rem.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/end_rem.Rdata")

load("/Users/katehayes/CLmodelR/Output/Data/Input/t_ss.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_i10.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_i11.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_i12.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_i13.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_i14.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_i15.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_i16.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_i17.Rdata")

load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_ec10.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_ec11.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_ec12.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_ec13.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_ec14.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_ec15.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_ec16.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/ss_ec17.Rdata")

load("/Users/katehayes/CLmodelR/Output/Data/Input/tnp.Rdata")

load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csi10.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csi11.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csi12.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csi13.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csi14.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csi15.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csi16.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csi17.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csec10.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csec11.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csec12.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csec13.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csec14.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csec15.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csec16.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2csec17.Rdata")

load("/Users/katehayes/CLmodelR/Output/Data/Input/np2nci10.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2nci11.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2nci12.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2nci13.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2nci14.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2nci15.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2nci16.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2nci17.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2ncec10.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2ncec11.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2ncec12.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2ncec13.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2ncec14.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2ncec15.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2ncec16.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/np2ncec17.Rdata")


load("/Users/katehayes/CLmodelR/Output/Data/Input/t_miss.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/miss_1014.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/miss_1517.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/miss_rc1014.Rdata")
load("/Users/katehayes/CLmodelR/Output/Data/Input/miss_rc1517.Rdata")


pars <- list(x = rbind(c(0.6, 0.4), #first row is group 1's mixing group 1,2,3,4,5
                       c(0.4, 0.6)),

             alpha = 0.8,
             beta = 0.95,

             tt = t_turn10,
             y = v_turn10,

             t_ec = t_end_cust,
             ec10 = end_cust10,
             ec11 = end_cust11,
             ec12 = end_cust12,
             ec13 = end_cust13,
             ec14 = end_cust14,
             ec15 = end_cust15,
             ec16 = end_cust16,
             ec17 = end_cust17,

             t_er = t_end_rem,
             er = end_rem,

             tss = t_ss,
             ssi10 = ss_i10,
             ssi11 = ss_i11,
             ssi12 = ss_i12,
             ssi13 = ss_i13,
             ssi14 = ss_i14,
             ssi15 = ss_i15,
             ssi16 = ss_i16,
             ssi17 = ss_i17,
             ssec10 = ss_ec10,
             ssec11 = ss_ec11,
             ssec12 = ss_ec12,
             ssec13 = ss_ec13,
             ssec14 = ss_ec14,
             ssec15 = ss_ec15,
             ssec16 = ss_ec16,
             ssec17 = ss_ec17,

             tn = tnp,
             n2ci10 = np2csi10,
             n2ci11 = np2csi11,
             n2ci12 = np2csi12,
             n2ci13 = np2csi13,
             n2ci14 = np2csi14,
             n2ci15 = np2csi15,
             n2ci16 = np2csi16,
             n2ci17 = np2csi17,
             n2cec10 = np2csec10,
             n2cec11 = np2csec11,
             n2cec12 = np2csec12,
             n2cec13 = np2csec13,
             n2cec14 = np2csec14,
             n2cec15 = np2csec15,
             n2cec16 = np2csec16,
             n2cec17 = np2csec17,

             n2ni10 = np2nci10,
             n2ni11 = np2nci11,
             n2ni12 = np2nci12,
             n2ni13 = np2nci13,
             n2ni14 = np2nci14,
             n2ni15 = np2nci15,
             n2ni16 = np2nci16,
             n2ni17 = np2nci17,
             n2nec10 = np2ncec10,
             n2nec11 = np2ncec11,
             n2nec12 = np2ncec12,
             n2nec13 = np2ncec13,
             n2nec14 = np2ncec14,
             n2nec15 = np2ncec15,
             n2nec16 = np2ncec16,
             n2nec17 = np2ncec17,


             tm = t_miss,
             miss1014 = miss_1014,
             miss1517 = miss_1517,
             missrc1014 = miss_rc1014,
             missrc1517 = miss_rc1517,



             # INITIAL CONDITIONS
             Uin10_ini = c(5198.06,4855.452),
             Uen10_ini = c(2203.5,2077.36),
             Ucn10_ini = c(0,0),
             Uis10_ini = c(1.12,0.224),
             Ues10_ini = c(5.6,1.12),
             Ucs10_ini = c(7,1.4),
             Uinc10_ini = c(1.12,0.224),
             Uenc10_ini = c(5.6,1.12),
             Ucnc10_ini = c(7,1.4),

             Uin11_ini = c(5296.9,4898.18),
             Uen11_ini = c(2241.5,2092.6),
             Ucn11_ini = c(0,0),
             Uis11_ini = c(2.8,0.56),
             Ues11_ini = c(14,2.8),
             Ucs11_ini = c(17.5,3.5),
             Uinc11_ini = c(2.8,0.56),
             Uenc11_ini = c(14,2.8),
             Ucnc11_ini = c(17.5,3.5),

             Uin12_ini = c(5224.8,5045.18),
             Uen12_ini = c(2197.6,2147.1),
             Ucn12_ini = c(0,0),
             Uis12_ini = c(2.8,0.56),
             Ues12_ini = c(14,2.8),
             Ucs12_ini = c(17.5,3.5),
             Uinc12_ini = c(2.8,0.56),
             Uenc12_ini = c(14,2.8),
             Ucnc12_ini = c(17.5,3.5),

             Uin13_ini = c(5362,5101.46),
             Uen13_ini = c(2222.133333,2166.1),
             Ucn13_ini = c(0,0),
             Uis13_ini = c(5.6,1.12),
             Ues13_ini = c(28,5.6),
             Ucs13_ini = c(35,7),
             Uinc13_ini = c(5.6,1.12),
             Uenc13_ini = c(28,5.6),
             Ucnc13_ini = c(35,7),

             Uin14_ini = c(5096.7,5037.06),
             Uen14_ini = c(2082.433333,2123.5),
             Ucn14_ini = c(0,0),
             Uis14_ini = c(5.6,1.12),
             Ues14_ini = c(28,5.6),
             Ucs14_ini = c(35,7),
             Uinc14_ini = c(5.6,1.12),
             Uenc14_ini = c(28,5.6),
             Ucnc14_ini = c(35,7),

             Uin15_ini = c(5052.6,4937.52),
             Uen15_ini = c(1956.333333,2050.6),
             Ucn15_ini = c(0,0),
             Uis15_ini = c(11.2,2.24),
             Ues15_ini = c(56,11.2),
             Ucs15_ini = c(70,14),
             Uinc15_ini = c(11.2,2.24),
             Uenc15_ini = c(56,11.2),
             Ucnc15_ini = c(70,14),

             Uin16_ini = c(5232.566667,4988.48),
             Uen16_ini = c(2001.5,2067.2),
             Ucn16_ini = c(0,0),
             Uis16_ini = c(16.8,3.36),
             Ues16_ini = c(84,16.8),
             Ucs16_ini = c(105,21),
             Uinc16_ini = c(16.8,3.36),
             Uenc16_ini = c(84,16.8),
             Ucnc16_ini = c(105,21),

             Uin17_ini = c(5232.566667,4988.48),
             Uen17_ini = c(2001.5,2067.2),
             Ucn17_ini = c(0,0),
             Uis17_ini = c(16.8,3.36),
             Ues17_ini = c(84,16.8),
             Ucs17_ini = c(105,21),
             Uinc17_ini = c(16.8,3.36),
             Uenc17_ini = c(84,16.8),
             Ucnc17_ini = c(105,21),

             Uics10_ini = c(0,0),
             Uecs10_ini = c(0,0),
             Uccs10_ini = c(0,0),
             Uicrf10_ini = c(0,0),
             Uecrf10_ini = c(0,0),
             Uccrf10_ini = c(0,0),
             Uicrr10_ini = c(0,0),
             Uecrr10_ini = c(0,0),
             Uccrr10_ini = c(0,0),

             Uics11_ini = c(0,0),
             Uecs11_ini = c(0,0),
             Uccs11_ini = c(0.1666666667,0),
             Uicrf11_ini = c(0,0),
             Uecrf11_ini = c(0,0),
             Uccrf11_ini = c(0.5,0),
             Uicrr11_ini = c(0,0),
             Uecrr11_ini = c(0,0),
             Uccrr11_ini = c(0.5,0),

             Uics12_ini = c(0,0),
             Uecs12_ini = c(0,0),
             Uccs12_ini = c(0.3333333333,0),
             Uicrf12_ini = c(0,0),
             Uecrf12_ini = c(0,0),
             Uccrf12_ini = c(0,0),
             Uicrr12_ini = c(0,0),
             Uecrr12_ini = c(0,0),
             Uccrr12_ini = c(1,0),

             Uics13_ini = c(0,0),
             Uecs13_ini = c(0.1666666667,0),
             Uccs13_ini = c(0.3333333333,0),
             Uicrf13_ini = c(0,0),
             Uecrf13_ini = c(0,0),
             Uccrf13_ini = c(0.5,0),
             Uicrr13_ini = c(0,1),
             Uecrr13_ini = c(0.5,0),
             Uccrr13_ini = c(1,0),

             Uics14_ini = c(0,0),
             Uecs14_ini = c(0.6666666667,0),
             Uccs14_ini = c(1,0.08333333333),
             Uicrf14_ini = c(0,0),
             Uecrf14_ini = c(0,0),
             Uccrf14_ini = c(1,0.25),
             Uicrr14_ini = c(0,0),
             Uecrr14_ini = c(2,0),
             Uccrr14_ini = c(3,0.25),

             Uics15_ini = c(0,0),
             Uecs15_ini = c(1.666666667,0),
             Uccs15_ini = c(2.666666667,0.1666666667),
             Uicrf15_ini = c(0,0),
             Uecrf15_ini = c(1,0),
             Uccrf15_ini = c(1,0.5),
             Uicrr15_ini = c(0,0),
             Uecrr15_ini = c(3,0),
             Uccrr15_ini = c(2,0.5),

             Uics16_ini = c(0.3333333333,0),
             Uecs16_ini = c(2,0),
             Uccs16_ini = c(3.333333333,0.1666666667),
             Uicrf16_ini = c(1,0),
             Uecrf16_ini = c(6,0),
             Uccrf16_ini = c(2,0.5),
             Uicrr16_ini = c(1,0),
             Uecrr16_ini = c(2,0),
             Uccrr16_ini = c(6,0.5),

             Uics17_ini = c(0.3333333333,0),
             Uecs17_ini = c(2,0),
             Uccs17_ini = c(3.333333333,0.1666666667),
             Uicrf17_ini = c(1,0),
             Uecrf17_ini = c(6,0),
             Uccrf17_ini = c(2,0.5),
             Uicrr17_ini = c(1,0),
             Uecrr17_ini = c(3,0),
             Uccrr17_ini = c(3,0.5),

             Win10_ini = c(0,0),
             Wen10_ini = c(0,0),
             Wcn10_ini = c(0,0),
             Wis10_ini = c(0,0),
             Wes10_ini = c(0,0),
             Wcs10_ini = c(0,0),
             Winc10_ini = c(0,0),
             Wenc10_ini = c(0,0),
             Wcnc10_ini = c(0,0),

             Win11_ini = c(0,0),
             Wen11_ini = c(0,0),
             Wcn11_ini = c(0,0),
             Wis11_ini = c(0,0),
             Wes11_ini = c(0,0),
             Wcs11_ini = c(0,0),
             Winc11_ini = c(0,0),
             Wenc11_ini = c(0,0),
             Wcnc11_ini = c(0,0),

             Win12_ini = c(0,0),
             Wen12_ini = c(0,0),
             Wcn12_ini = c(0,0),
             Wis12_ini = c(0,0),
             Wes12_ini = c(0,0),
             Wcs12_ini = c(0,0),
             Winc12_ini = c(0,0),
             Wenc12_ini = c(0,0),
             Wcnc12_ini = c(0,0),

             Win13_ini = c(0,0),
             Wen13_ini = c(0,0),
             Wcn13_ini = c(0,0),
             Wis13_ini = c(0,0),
             Wes13_ini = c(0,0),
             Wcs13_ini = c(0,0),
             Winc13_ini = c(0,0),
             Wenc13_ini = c(0,0),
             Wcnc13_ini = c(0,0),

             Win14_ini = c(0,0),
             Wen14_ini = c(0,0),
             Wcn14_ini = c(0,0),
             Wis14_ini = c(0,0),
             Wes14_ini = c(0,0),
             Wcs14_ini = c(0,0),
             Winc14_ini = c(0,0),
             Wenc14_ini = c(0,0),
             Wcnc14_ini = c(0,0),

             Win15_ini = c(0,0),
             Wen15_ini = c(2,0),
             Wcn15_ini = c(0,0),
             Wis15_ini = c(1,0),
             Wes15_ini = c(0,0),
             Wcs15_ini = c(0,0),
             Winc15_ini = c(0,0),
             Wenc15_ini = c(3,0),
             Wcnc15_ini = c(0,0),

             Win16_ini = c(0,0),
             Wen16_ini = c(0,0),
             Wcn16_ini = c(0,0),
             Wis16_ini = c(0,0),
             Wes16_ini = c(6,0),
             Wcs16_ini = c(1,0),
             Winc16_ini = c(0,0),
             Wenc16_ini = c(3,0),
             Wcnc16_ini = c(5,0),

             Win17_ini = c(0,0),
             Wen17_ini = c(0,0),
             Wcn17_ini = c(0,0),
             Wis17_ini = c(0,0),
             Wes17_ini = c(3,1),
             Wcs17_ini = c(2,0),
             Winc17_ini = c(0.5,0),
             Wenc17_ini = c(10,0.5),
             Wcnc17_ini = c(3,0),

             Wics10_ini = c(0,0),
             Wecs10_ini = c(0,0),
             Wccs10_ini = c(0,0),
             Wicrf10_ini = c(0,0),
             Wecrf10_ini = c(0,0),
             Wccrf10_ini = c(0,0),
             Wicrr10_ini = c(0,0),
             Wecrr10_ini = c(0,0),
             Wccrr10_ini = c(0,0),

             Wics11_ini = c(0,0),
             Wecs11_ini = c(0,0),
             Wccs11_ini = c(0,0),
             Wicrf11_ini = c(0,0),
             Wecrf11_ini = c(0,0),
             Wccrf11_ini = c(0,0),
             Wicrr11_ini = c(0,0),
             Wecrr11_ini = c(0,0),
             Wccrr11_ini = c(0,0),

             Wics12_ini = c(0,0),
             Wecs12_ini = c(0,0),
             Wccs12_ini = c(0,0),
             Wicrf12_ini = c(0,0),
             Wecrf12_ini = c(0,0),
             Wccrf12_ini = c(0,0),
             Wicrr12_ini = c(0,0),
             Wecrr12_ini = c(0,0),
             Wccrr12_ini = c(0,0),

             Wics13_ini = c(0,0),
             Wecs13_ini = c(0,0),
             Wccs13_ini = c(0,0),
             Wicrf13_ini = c(0,0),
             Wecrf13_ini = c(0,0),
             Wccrf13_ini = c(0,0),
             Wicrr13_ini = c(0,0),
             Wecrr13_ini = c(0,0),
             Wccrr13_ini = c(0,0),

             Wics14_ini = c(0,0),
             Wecs14_ini = c(0,0),
             Wccs14_ini = c(1,0),
             Wicrf14_ini = c(0,0),
             Wecrf14_ini = c(0,0),
             Wccrf14_ini = c(1,0),
             Wicrr14_ini = c(0,0),
             Wecrr14_ini = c(0,0),
             Wccrr14_ini = c(1,0),

             Wics15_ini = c(0,0),
             Wecs15_ini = c(0,0),
             Wccs15_ini = c(0,0),
             Wicrf15_ini = c(0,0),
             Wecrf15_ini = c(0,0),
             Wccrf15_ini = c(0,0),
             Wicrr15_ini = c(0,0),
             Wecrr15_ini = c(0,0),
             Wccrr15_ini = c(0,0),

             Wics16_ini = c(0,0),
             Wecs16_ini = c(0,0),
             Wccs16_ini = c(2,0),
             Wicrf16_ini = c(0,0),
             Wecrf16_ini = c(0,0),
             Wccrf16_ini = c(1,0),
             Wicrr16_ini = c(0,0),
             Wecrr16_ini = c(0,0),
             Wccrr16_ini = c(1,0),

             Wics17_ini = c(0,0),
             Wecs17_ini = c(0,0),
             Wccs17_ini = c(1,0),
             Wicrf17_ini = c(0,0),
             Wecrf17_ini = c(2,0),
             Wccrf17_ini = c(1,3),
             Wicrr17_ini = c(0,0),
             Wecrr17_ini = c(2,0),
             Wccrr17_ini = c(3,1),



             # PARAMETERS
             # turn10 = c(142,132), #boys, girls  coming in weekly - should be set to [151, 141] <- old numberw!





             pc_incl = c(0.70,0.80), #percent boys, girls  coming in going to excluded
             pc_excl = c(0.29,0.19), #percent boys, girls  coming in going to excluded
             pc_close = c(0.01,0.01), #percent boys, girls  coming in going to close

             contact = c(7), #contact rate per week - 1 a day for 7 days?
             recruit_i = c(0.001,0.00007),
             recruit_e = c(0.0025,0.0015),
             recruit_c = c(0.005,0.003),
             recruit_cust = c(0.006,0.005),
             associate_i = c(0.0002,0.00001),
             associate_e = c(0.001,0.0009),
             associate_c = c(0.009,0.004),
             r2c = c(0.33), #percentage of custody remands that result in a custodial sentence
             # r2nc = c(0.33), #percentage of custody remands that result in a non-custodial sentence
             r2a = c(0.33), #percentage of custody remands that result acquittal

             # end_rem = c(0.175), #rate that sets the length of the average custody remand - should be 40 so 5.7 weeks, 1/5.7
             # end_cust = c(0.05), #rate that sets the length of the custodial sentence - meant to be 139 so lets say 20 weeks, 1/20

             deter = c(0.0001), #rate of CL workers resolving to stop while doing a custodial sentence (note, they can be recruited back later)
             desist = c(0.00019), #probability of desisting at other times (after 12 months on av? should be longer maybe?)

             np2rem_i10 = c(0.00001, 0.00001),
             np2rem_e10 = c(0.00001, 0.00001),
             np2rem_c10 = c(0.00001, 0.00001),
             np2rem_i11 = c(0.00001, 0.00001),
             np2rem_e11 = c(0.00001, 0.00001),
             np2rem_c11 = c(0.00001, 0.00001),
             np2rem_i12 = c(0.00001, 0.00001),
             np2rem_e12 = c(0.00001, 0.00001),
             np2rem_c12 = c(0.00001, 0.00001),
             np2rem_i13 = c(0.00001, 0.00001),
             np2rem_e13 = c(0.00001, 0.00001),
             np2rem_c13 = c(0.00001, 0.00001),
             np2rem_i14 = c(0.00001, 0.00001),
             np2rem_e14 = c(0.00001, 0.00001),
             np2rem_c14 = c(0.00001, 0.00001),
             np2rem_i15 = c(0.00001, 0.00001),
             np2rem_e15 = c(0.00001, 0.00001),
             np2rem_c15 = c(0.00001, 0.00001),
             np2rem_i16 = c(0.00001, 0.00001),
             np2rem_e16 = c(0.00001, 0.00001),
             np2rem_c16 = c(0.00001, 0.00001),
             np2rem_i17 = c(0.00001, 0.00001),
             np2rem_e17 = c(0.00001, 0.00001),
             np2rem_c17 = c(0.00001, 0.00001),

             # np2nc_i10 = c(0.00001, 0.00001),
             # np2nc_e10 = c(0.00001, 0.00001),
             # np2nc_c10 = c(0.00001, 0.00001),
             # np2nc_i11 = c(0.00001, 0.00001),
             # np2nc_e11 = c(0.00001, 0.00001),
             # np2nc_c11 = c(0.00001, 0.00001),
             # np2nc_i12 = c(0.00001, 0.00001),
             # np2nc_e12 = c(0.00001, 0.00001),
             # np2nc_c12 = c(0.00001, 0.00001),
             # np2nc_i13 = c(0.00001, 0.00001),
             # np2nc_e13 = c(0.00001, 0.00001),
             # np2nc_c13 = c(0.00001, 0.00001),
             # np2nc_i14 = c(0.00001, 0.00001),
             # np2nc_e14 = c(0.00001, 0.00001),
             # np2nc_c14 = c(0.00001, 0.00001),
             # np2nc_i15 = c(0.00001, 0.00001),
             # np2nc_e15 = c(0.00001, 0.00001),
             # np2nc_c15 = c(0.00001, 0.00001),
             # np2nc_i16 = c(0.00001, 0.00001),
             # np2nc_e16 = c(0.00001, 0.00001),
             # np2nc_c16 = c(0.00001, 0.00001),
             # np2nc_i17 = c(0.00001, 0.00001),
             # np2nc_e17 = c(0.00001, 0.00001),
             # np2nc_c17 = c(0.00001, 0.00001),
             #
             # np2cust_i10 = c(0.00001, 0.00001),
             # np2cust_e10 = c(0.00001, 0.00001),
             # np2cust_c10 = c(0.00001, 0.00001),
             # np2cust_i11 = c(0.00001, 0.00001),
             # np2cust_e11 = c(0.00001, 0.00001),
             # np2cust_c11 = c(0.00001, 0.00001),
             # np2cust_i12 = c(0.00001, 0.00001),
             # np2cust_e12 = c(0.00001, 0.00001),
             # np2cust_c12 = c(0.00001, 0.00001),
             # np2cust_i13 = c(0.00001, 0.00001),
             # np2cust_e13 = c(0.00001, 0.00001),
             # np2cust_c13 = c(0.00001, 0.00001),
             # np2cust_i14 = c(0.00001, 0.00001),
             # np2cust_e14 = c(0.00001, 0.00001),
             # np2cust_c14 = c(0.00001, 0.00001),
             # np2cust_i15 = c(0.00001, 0.00001),
             # np2cust_e15 = c(0.00001, 0.00001),
             # np2cust_c15 = c(0.00001, 0.00001),
             # np2cust_i16 = c(0.00001, 0.00001),
             # np2cust_e16 = c(0.00001, 0.00001),
             # np2cust_c16 = c(0.00001, 0.00001),
             # np2cust_i17 = c(0.00001, 0.00001),
             # np2cust_e17 = c(0.00001, 0.00001),
             # np2cust_c17 = c(0.00001, 0.00001),


             ######### yes priors to remand, nc, custodial states############################
             prior2rem_i10 = c(0.00001, 0.00001),
             prior2rem_e10 = c(0.00001, 0.00001),
             prior2rem_c10 = c(0.00001, 0.00001),
             prior2rem_i11 = c(0.00001, 0.00001),
             prior2rem_e11 = c(0.00001, 0.00001),
             prior2rem_c11 = c(0.00001, 0.00001),
             prior2rem_i12 = c(0.00001, 0.00001),
             prior2rem_e12 = c(0.00001, 0.00001),
             prior2rem_c12 = c(0.00001, 0.00001),
             prior2rem_i13 = c(0.00001, 0.00001),
             prior2rem_e13 = c(0.00001, 0.00001),
             prior2rem_c13 = c(0.00001, 0.00001),
             prior2rem_i14 = c(0.00001, 0.00001),
             prior2rem_e14 = c(0.00001, 0.00001),
             prior2rem_c14 = c(0.00001, 0.00001),
             prior2rem_i15 = c(0.00001, 0.00001),
             prior2rem_e15 = c(0.00001, 0.00001),
             prior2rem_c15 = c(0.00001, 0.00001),
             prior2rem_i16 = c(0.00001, 0.00001),
             prior2rem_e16 = c(0.00001, 0.00001),
             prior2rem_c16 = c(0.00001, 0.00001),
             prior2rem_i17 = c(0.00001, 0.00001),
             prior2rem_e17 = c(0.00001, 0.00001),
             prior2rem_c17 = c(0.00001, 0.00001),

             prior2nc_i10 = c(0.00001, 0.00001),
             prior2nc_e10 = c(0.00001, 0.00001),
             prior2nc_c10 = c(0.00001, 0.00001),
             prior2nc_i11 = c(0.00001, 0.00001),
             prior2nc_e11 = c(0.00001, 0.00001),
             prior2nc_c11 = c(0.00001, 0.00001),
             prior2nc_i12 = c(0.00001, 0.00001),
             prior2nc_e12 = c(0.00001, 0.00001),
             prior2nc_c12 = c(0.00001, 0.00001),
             prior2nc_i13 = c(0.00001, 0.00001),
             prior2nc_e13 = c(0.00001, 0.00001),
             prior2nc_c13 = c(0.00001, 0.00001),
             prior2nc_i14 = c(0.00001, 0.00001),
             prior2nc_e14 = c(0.00001, 0.00001),
             prior2nc_c14 = c(0.00001, 0.00001),
             prior2nc_i15 = c(0.00001, 0.00001),
             prior2nc_e15 = c(0.00001, 0.00001),
             prior2nc_c15 = c(0.001, 0.001),
             prior2nc_i16 = c(0.00001, 0.00001),
             prior2nc_e16 = c(0.001, 0.001),
             prior2nc_c16 = c(0.001, 0.001),
             prior2nc_i17 = c(0.00001, 0.00001),
             prior2nc_e17 = c(0.001, 0.001),
             prior2nc_c17 = c(0.001, 0.001),

             prior2cust_i10 = c(0.00001, 0.00001),
             prior2cust_e10 = c(0.00001, 0.00001),
             prior2cust_c10 = c(0.00001, 0.00001),
             prior2cust_i11 = c(0.00001, 0.00001),
             prior2cust_e11 = c(0.00001, 0.00001),
             prior2cust_c11 = c(0.00001, 0.00001),
             prior2cust_i12 = c(0.00001, 0.00001),
             prior2cust_e12 = c(0.00001, 0.00001),
             prior2cust_c12 = c(0.00001, 0.00001),
             prior2cust_i13 = c(0.00001, 0.00001),
             prior2cust_e13 = c(0.00001, 0.00001),
             prior2cust_c13 = c(0.00001, 0.00001),
             prior2cust_i14 = c(0.00001, 0.00001),
             prior2cust_e14 = c(0.00001, 0.00001),
             prior2cust_c14 = c(0.0001, 0.0001),
             prior2cust_i15 = c(0.00001, 0.00001),
             prior2cust_e15 = c(0.00001, 0.00001),
             prior2cust_c15 = c(0.0001, 0.0001),
             prior2cust_i16 = c(0.00001, 0.00001),
             prior2cust_e16 = c(0.0001, 0.0001),
             prior2cust_c16 = c(0.0001, 0.0001),
             prior2cust_i17 = c(0.00001, 0.00001),
             prior2cust_e17 = c(0.0001, 0.0001),
             prior2cust_c17 = c(0.001, 0.0001),

             arrest_uin10 = c(0,0),
             arrest_uen10 = c(0,0),
             arrest_ucn10 = c(0,0),
             arrest_win10 = c(0,0),
             arrest_wen10 = c(0,0),
             arrest_wcn10 = c(0,0),
             arrest_uin11 = c(0,0),
             arrest_uen11 = c(0,0),
             arrest_ucn11 = c(0,0),
             arrest_win11 = c(0,0),
             arrest_wen11 = c(0,0),
             arrest_wcn11 = c(0,0),
             arrest_uin12 = c(0,0),
             arrest_uen12 = c(0,0),
             arrest_ucn12 = c(0,0),
             arrest_win12 = c(0,0),
             arrest_wen12 = c(0,0),
             arrest_wcn12 = c(0,0),
             arrest_uin13 = c(0,0),
             arrest_uen13 = c(0,0),
             arrest_ucn13 = c(0,0),
             arrest_win13 = c(0,0),
             arrest_wen13 = c(0,0),
             arrest_wcn13 = c(0,0),
             arrest_uin14 = c(0,0),
             arrest_uen14 = c(0,0),
             arrest_ucn14 = c(0,0),
             arrest_win14 = c(0,0),
             arrest_wen14 = c(0,0),
             arrest_wcn14 = c(0,0),
             arrest_uin15 = c(0,0),
             arrest_uen15 = c(0,0),
             arrest_ucn15 = c(0,0),
             arrest_win15 = c(0,0),
             arrest_wen15 = c(0,0),
             arrest_wcn15 = c(0,0),
             arrest_uin16 = c(0,0),
             arrest_uen16 = c(0,0),
             arrest_ucn16 = c(0,0),
             arrest_win16 = c(0,0),
             arrest_wen16 = c(0,0),
             arrest_wcn16 = c(0,0),
             arrest_uin17 = c(0,0),
             arrest_uen17 = c(0,0),
             arrest_ucn17 = c(0,0),
             arrest_win17 = c(0,0),
             arrest_wen17 = c(0,0),
             arrest_wcn17 = c(0,0)
             # missing_uin10 = c(0,0),
             # missing_uen10 = c(0,0),
             # missing_ucn10 = c(0,0),
             # missing_win10 = c(0,0),
             # missing_wen10 = c(0,0),
             # missing_wcn10 = c(0,0),
             # missing_uin11 = c(0,0),
             # missing_uen11 = c(0,0),
             # missing_ucn11 = c(0,0),
             # missing_win11 = c(0,0),
             # missing_wen11 = c(0,0),
             # missing_wcn11 = c(0,0),
             # missing_uin12 = c(0,0),
             # missing_uen12 = c(0,0),
             # missing_ucn12 = c(0,0),
             # missing_win12 = c(0,0),
             # missing_wen12 = c(0,0),
             # missing_wcn12 = c(0,0),
             # missing_uin13 = c(0,0),
             # missing_uen13 = c(0,0),
             # missing_ucn13 = c(0,0),
             # missing_win13 = c(0,0),
             # missing_wen13 = c(0,0),
             # missing_wcn13 = c(0,0),
             # missing_uin14 = c(0,0),
             # missing_uen14 = c(0,0),
             # missing_ucn14 = c(0,0),
             # missing_win14 = c(0,0),
             # missing_wen14 = c(0,0),
             # missing_wcn14 = c(0,0),
             # missing_uin15 = c(0,0),
             # missing_uen15 = c(0,0),
             # missing_ucn15 = c(0,0),
             # missing_win15 = c(0,0),
             # missing_wen15 = c(0,0),
             # missing_wcn15 = c(0,0),
             # missing_uin16 = c(0,0),
             # missing_uen16 = c(0,0),
             # missing_ucn16 = c(0,0),
             # missing_win16 = c(0,0),
             # missing_wen16 = c(0,0),
             # missing_wcn16 = c(0,0),
             # missing_uin17 = c(0,0),
             # missing_uen17 = c(0,0),
             # missing_ucn17 = c(0,0),
             # missing_win17 = c(0,0),
             # missing_wen17 = c(0,0),
             # missing_wcn17 = c(0,0)
)



mod <- cl_draft$new(user = pars)
t <- seq(0, 520, length.out = 1041)  #from 0 to 10 years, two steps a week or something
CL_data <- as.data.frame(mod$run(t))

save(CL_data, file = "Output/Data/Output/CL_data.Rdata")



mod_states <- CL_data %>%
  select(t, starts_with("Uin1"), starts_with("Uis1"), starts_with("Uinc1"),
         starts_with("Uicrf1"),starts_with("Uicrr1"), starts_with("Uics1"), starts_with("Win1"),
         starts_with("Wis1"), starts_with("Winc1"), starts_with("Wicrf1"), starts_with("Wicrr1"),
         starts_with("Wics1"), starts_with("Uen1"), starts_with("Ues1"),
         starts_with("Uenc1"), starts_with("Uecrf1"), starts_with("Uecrr1"), starts_with("Uecs1"),
         starts_with("Wen1"), starts_with("Wes1"), starts_with("Wenc1"),
         starts_with("Wecrf1"), starts_with("Wecrr1"), starts_with("Wecs1"), starts_with("Ucn1"),
         starts_with("Ucs1"), starts_with("Ucnc1"), starts_with("Uccrf1"), starts_with("Uccrr1"),
         starts_with("Uccs1"), starts_with("Wcn1"), starts_with("Wcs1"),
         starts_with("Wcnc1"), starts_with("Wccrf1"), starts_with("Wccrr1"), starts_with("Wccs1")) %>%
  pivot_longer(-t, names_to = "state", values_to = "count") %>%
  mutate(age = as.numeric(str_extract_all(state, "(\\d{2})")),
         gender = if_else(grepl("\\[1\\]", state), "Boy", "Girl"),
         state = str_remove(state, "(\\d{2})"),
         state = str_remove(state, "\\[\\d{1}\\]"),
         cl_status = if_else(grepl("U", state), "Uninvolved", "Working"),
         class = substring(state, 2, 2),
         cjs_pos = str_remove_all(state,"U"),
         cjs_pos = str_remove_all(cjs_pos,"W"),
         cjs_pos = sub('.', '', cjs_pos)) %>%
  select(-state) %>%
  mutate(class = case_when(class == "i" ~ "Included",
                           class == "e" ~ "Excluded",
                           class == "c" ~ "Close"),
         cjs_pos = case_when(cjs_pos == "n" ~ "No contact",
                             cjs_pos == "s" ~ "Surveilled",
                             cjs_pos == "nc" ~ "Non-custodial",
                             cjs_pos == "crf" ~ "Custodial remand (fte)",
                             cjs_pos == "crr" ~ "Custodial remand (rep)",
                             cjs_pos == "cs" ~ "Custodial sentence"))

save(mod_states, file = "Output/Data/Output/mod_states.Rdata")





